@if (item()) {
<div class="detail-page">
  <button class="back" (click)="goBack()">← Back</button>

  <div class="detail">
    <div class="image">
      <img [src]="item()!.image || fallbackImage" [alt]="item()!.name" />
    </div>

    <div class="info">
      @if (!isEditing) {
        <div class="category-badge">{{ item()!.category }}</div>
        <h1>{{ item()!.name }}</h1>

        <div class="info-section">
          <p class="label">Current Stock</p>
          <p class="big" [class.low-stock]="isLowStock()">
            {{ item()!.quantity }}
          </p>
          @if (isLowStock()) {
            <p class="low-stock-warning">⚠️ Low stock alert</p>
          }
        </div>

        <div class="info-section">
          <p class="label">Low Stock Threshold</p>
          <p>{{ item()!.lowStockThreshold ?? 5 }}</p>
        </div>

        @if (item()!.notes) {
          <div class="info-section">
            <p class="label">Notes</p>
            <p class="notes-text">{{ item()!.notes }}</p>
          </div>
        }

        <div class="info-section">
          <p class="label">Item ID</p>
          <p class="item-id">{{ item()!.id }}</p>
        </div>
      } @else {
        <div class="edit-form">
          <div class="form-group">
            <label>Name</label>
            <input
              type="text"
              class="input-field"
              [value]="editedName"
              (input)="editedName = $any($event.target).value"
              placeholder="Item name"
            />
          </div>

          <div class="form-group">
            <label>Category</label>
            <select
              class="input-field"
              [value]="editedCategory"
              (change)="editedCategory = $any($event.target).value"
            >
              @for (cat of categories; track cat) {
                <option [value]="cat">{{ cat }}</option>
              }
            </select>
          </div>

          <div class="form-group">
            <label>Quantity</label>
            <input
              type="number"
              class="input-field"
              [value]="editedQuantity"
              (input)="editedQuantity = +$any($event.target).value"
              min="0"
            />
          </div>

          <div class="form-group">
            <label>Low Stock Threshold</label>
            <input
              type="number"
              class="input-field"
              [value]="editedLowStockThreshold"
              (input)="editedLowStockThreshold = +$any($event.target).value"
              min="0"
            />
          </div>

          <div class="form-group">
            <label>Notes</label>
            <textarea
              class="input-field textarea"
              [value]="editedNotes"
              (input)="editedNotes = $any($event.target).value"
              placeholder="Add notes about this item..."
              rows="3"
            ></textarea>
          </div>

          <div class="form-group">
            <label>Image URL</label>
            <input
              type="text"
              class="input-field"
              [value]="editedImage"
              (input)="editedImage = $any($event.target).value"
              placeholder="Image URL"
            />
          </div>
        </div>
      }

      <div class="actions">
        @if (!isEditing) {
          <button class="edit-btn" (click)="startEdit()">Edit</button>
          <button class="delete-btn" (click)="deleteItem()">Delete</button>
        } @else {
          <button class="save-btn" (click)="saveEdit()">Save</button>
          <button class="cancel-btn" (click)="cancelEdit()">Cancel</button>
        }
      </div>
    </div>
  </div>
</div>
}
